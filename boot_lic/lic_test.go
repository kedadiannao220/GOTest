package boot_lic

import (
	"crypto/md5"
	"encoding/base64"
	"encoding/json"
	"fmt"
	"io/ioutil"
	"os"
	"testing"
	"time"

	"github.com/wenzhenxi/gorsa"

	"kedadiannao220/basic"
)

const buttonPermission = "/Users/admin/Documents/workspace/go/cloudboot_pro/doc/conf/cloudboot_button_permission.json"
const menuPermission = "/Users/admin/Documents/workspace/go/cloudboot_pro/doc/conf/cloudboot_menu_permisson.json"

const priKey = `-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`

const pubKey = `-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA42q+9LPVnmKZKFnan3R+
GixIuEIngNgUbIawtObvJDg50GkbHay1xD/YXHOMOUKsBSc01Pv35xNjQcNj8J50
3d32sx94HqaYHUJyNh0P/E02fAO2KxAd1iHAoUd4R5mhju07KMHuPYFQlPPru/ui
N2EcpifUJvG9Jc1P3CWAh3j8/XZFKf4+1e+z26LvXYDwEs4SljLgTfyXAqczf534
GB+lFSD65i1eRLmGxS3q7fzVHeXN4i1lqfpAuGoE4xUYymRr3dAUNCkZO0umKg1R
71a49jBChoUi04Akp5pawd6Qf8EpAGLkoXC7+9xR5mkEGVm+O1u2cSiDwxLdGfbZ
xEuMq1DNGYlPekBWL7fy5WL4U4Tqpeg5zFS8qmLeRr39LP3YakoHJWS4KuInf8Mk
PLrdFRy/M/YbWfaIJ8TmriEQouPpNYHNqUUaWs1CNBQ8goc9NXunTkwB8E+Yq1F2
QOFOTe1YSZXwOE3bc86ZsyXi2uFNquGjzIo7KdqOvkmd9biXX9rjpfODyFaMVgYO
mI6IsqkXPO2Dx8eqlCaHHXhHfsEGGwL96xnnuR9VYLvjvM3+3ciCvjBqRN78ZkbS
rOtKz+phGnoccR6UORW8s3dAplMLsvEJdzXyHD4Wvkiag0jy24U1orCoXYhLjKpi
0AaJI5niXvDhWMyCAsjo760CAwEAAQ==
-----END PUBLIC KEY-----`

// License License内容结构体
type License struct {
	Customer          string `json:"Company"`
	CustomerCode      string `json:"CompanyCode"`
	MaxDeviceNo       uint   `json:"DeviceNum"`
	MaxUserNo         uint   `json:"UserNum"`
	Type              string `json:"LicenseType"` // 类型。OFFICIAL-正式; TRIAL-测试;
	Licensor          string `json:"Licensor"`
	IsMultiTenant     bool   `json:"MultiTenant"`
	Product           string `json:"Product"`
	StartTime         string `json:"StartTime"`
	EndTime           string `json:"Time"`
	IsMustActivate    string `json:"IsMustActivate"` // 是否须要激活。Y-是; N-否;
	ActivationCode    string `json:"ActivationFingerCode"`
	ServerFingerprint string `json:"ServerFingerCode"`
	Extra             string `json:"ExtraInfo"` // 扩展信息。云霁每个产品自定义此字段。
}

type Permissions struct {
	ID       string        `json:"id"`
	Title    string        `json:"title"`
	Note     string        `json:"note"`
	Children []Permissions `json:"children"`
}

type Extra struct {
	Permissions []string `json:"permissions"`
	Email       string   `json:"email"`
	PhoneNumber string   `json:"phone_number"`
}

type Resp struct {
	Content Permissions `json:"content"`
	Message string      `json:"message"`
	Status  string      `json:"status"`
}

func getAllKey() string {
	bp, _ := os.Open(buttonPermission)
	mp, _ := os.Open(menuPermission)

	bpbytes, _ := ioutil.ReadAll(bp)
	mpbytes, _ := ioutil.ReadAll(mp)

	var bpResp Resp
	var mpResp Resp

	_ = json.Unmarshal(bpbytes, &bpResp)
	_ = json.Unmarshal(mpbytes, &mpResp)

	//fmt.Println(bpResp.Content)
	//fmt.Println(mpResp.Content)

	perMap := make(map[string]string)
	loop(bpResp.Content, perMap)
	loop(mpResp.Content, perMap)

	//fmt.Println(basic.ToJsonString(perMap))

	var keys []string
	for k, _ := range perMap {
		keys = append(keys, k)
	}

	extra := Extra{
		Permissions: keys,
	}
	return basic.ToJsonString(extra)
}

func loop(per Permissions, perMap map[string]string) {
	if per.ID != "" {
		perMap[per.ID] = per.Title
	}
	for _, child := range per.Children {
		loop(child, perMap)
	}
}

func TestGenLic(t *testing.T) {

	allKey := getAllKey()
	fmt.Printf("License extra info:\n%s\n", allKey)
	fmt.Printf("License extra base64:\n%s\n", base64.StdEncoding.EncodeToString([]byte(allKey)))

	lic := &License{
		Customer:       "测试客户",
		CustomerCode:   "test_code",
		MaxDeviceNo:    1000,
		MaxUserNo:      1000,
		Type:           "OFFICIAL",
		Licensor:       "杭州云霁科技有限公司",
		IsMultiTenant:  false,
		Product:        "CloudBoot",
		StartTime:      time.Now().Format("2006-01-02 15:04:05"),
		EndTime:        time.Now().Add(time.Hour * 24 * 30).Format("2006-01-02 15:04:05"),
		IsMustActivate: "Y",
		ActivationCode: fmt.Sprintf("%x", md5.Sum([]byte("hello"))),
		//ServerFingerprint: "fbd57756aedbdba13caa9a4e5f1f8a1c4e4a02e534af57654b8aad8b4de47099",
		ServerFingerprint: "05f360589deb7d50670e47746939b475c6ca04f52180d691ecb988c7a4180edd",
		Extra:             base64.StdEncoding.EncodeToString([]byte(allKey)),
	}

	bytes, _ := json.Marshal(lic)

	fmt.Printf("License 明文:\n%s\n", string(bytes))

	prienctypt, _ := gorsa.PriKeyEncrypt(string(bytes), priKey)
	fmt.Printf("License 密文:\n%s\n", prienctypt)

}

func TestDecodeLic(t *testing.T) {

	prienctypt := "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"
	pubdecrypt, err := gorsa.PublicDecrypt(prienctypt, pubKey)
	if err != nil {
		fmt.Fprintf(os.Stderr, "Error: %s", err.Error())
		return
	}
	fmt.Printf("License 解密:\n%s\n", pubdecrypt)

	var lic License
	if err := json.Unmarshal([]byte(pubdecrypt), &lic); err != nil {
		fmt.Fprintf(os.Stderr, "Error: %s", err.Error())
		return
	}

	extra, _ := base64.StdEncoding.DecodeString(lic.Extra)

	fmt.Printf("License extra info:\n%s\n", string(extra))

}
